(function(){var t,e,i,n,s,r=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1},o=function(t,e){return function(){return t.apply(e,arguments)}},l={}.hasOwnProperty,h=function(t,e){function i(){this.constructor=t}for(var n in e)l.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u=[].slice;n=function(){function t(t){null==t&&(t={}),this.options||(this.options={}),_.extend(this.options,t),this.events={}}return t.isObject=!0,t.prototype.initialize=function(){return this},t.prototype.on=function(t,e){if(!t)throw new Error("Event name missing.");if(!e)throw new Error("Event handler missing.");return this.events[t]||(this.events[t]=[]),r.call(this.events[t],e)<0&&this.events[t].push(e),this},t.prototype.once=function(t,e){var i;return i=function(n){return function(){return n.off(t,i),e.apply(n,arguments)}}(this),this.on(t,i)},t.prototype.off=function(t,e){var i;if(this.events[t])return i=this.events[t].indexOf(e),this.events[t].splice(i,1),this},t.prototype.trigger=function(t,e){var i,n,s,r,o;if(this.events[t]){for(r=this.events[t].slice(),o=[],n=0,s=r.length;s>n;n++)i=r[n],o.push(i.apply(this,e));return o}},t.prototype.get=function(t){return this[t]},t.prototype.set=function(t,e){return this[t]=e},t}(),"undefined"!=typeof module&&null!==module?exports.LRSObject=n:(window.lrs||(window.lrs={}),window.lrs.LRSObject=n),s=function(t){function e(t,i,n){null==t&&(t=null),this.options=null!=i?i:null,this.owner=n,this.delegateAction=o(this.delegateAction,this),!this.template||t&&0!==t.children.length?this.el=t:(this._loadTemplate(),t&&t.parentNode.replaceChild(this.el,t)),null==this.customOutlets&&(this.customOutlets={}),this._createViews(),this._createOutlets(),this._createActions(),e.__super__.constructor.call(this,this.options)}return h(e,t),e.defineOutlets=function(){return this.outletTypes={custom:{get:function(t,e){return t.get(e.el)},set:function(t,e,i){return t.set(e.el,i)}},input:{get:function(t){return"checkbox"===t.el.type?t.el.checked:t.el.value},set:function(t,e,i){return"checkbox"===t.el.type?t.el.checked=i?!0:!1:t.el.value=null!=i?i:""}},img:{get:function(t){return t.el.src},set:function(t,e,i){return t.el.src=null!=i?i||"":void 0}},html:{get:function(t){return t.el.innerHTML},set:function(t,e,i){return t.el.innerHTML=null!=i?i:""}}},this.outletTypes["default"]=this.outletTypes.html,this.outletTypes.textarea=this.outletTypes.input},e.defineOutlets(),e.isTouch=null===document.ontouchstart,e.prototype.isView=!0,e.views={},e.actionPattern=/^(.*?):(.*?)\((.*?)\)/,e.parseTemplates=function(){var t,e,i,n,s,r,o,l;if(!this.templates){for(this.templates={},s=document.querySelectorAll(".templates"),l=[],r=0,o=s.length;o>r;r++)i=s[r],i.parentNode.removeChild(i),n=document.createElement("div"),n.innerHTML=i.innerHTML,l.push(function(){var i,s,r,o;for(r=n.children,o=[],i=0,s=r.length;s>i;i++)e=r[i],e.hasAttribute("data-template")&&(t=e.getAttribute("data-template"),e.removeAttribute("data-template"),o.push(this.templates[t]=e.outerHTML));return o}.call(this));return l}},e.prototype.initialize=function(){return this.hidden=this.el.classList.contains("hidden"),this.enabled=!this.el.classList.contains("disabled"),this.initializeViews(),e.__super__.initialize.apply(this,arguments)},e.prototype.initializeViews=function(){return this.eachView(function(t){return t.initialize()})},e.prototype._loadTemplate=function(){var t;return t=document.createElement("div"),t.innerHTML=e.templates[this.template],this.el=t.firstChild},e.prototype._createViews=function(){var t,e,i,n,s,r,o,l;for(s=this.el.querySelectorAll("[data-view]"),this.views={},l=[],r=0,o=s.length;o>r;r++)n=s[r],n.hasAttribute("data-view")&&(t=n.getAttribute("data-view").split(":"),n.removeAttribute("data-view"),1===t.length?(e=t[0],i=new lrs.LRSView(n,null,this)):(e=t[1],i=new lrs.LRSView.views[t[0]+"View"](n,{subTemplate:t[2]},this)),"view"===e&&(this.view=i),this.views[e]?(Array.isArray(this.views[e])||(this.views[e]=[this.views[e]]),l.push(this.views[e].push(i))):l.push(this.views[e]=i));return l},e.prototype._createOutlets=function(){var t,e,i,n,s,r,o;for(this.outlets={},n=this.el.querySelectorAll("[data-outlet]"),this.el.hasAttribute("data-outlet")&&this._createOutlet(this.el),s=0,r=n.length;r>s;s++)i=n[s],this._createOutlet(i);if(this.customOutlets){o=this.customOutlets;for(t in o)e=o[t],e.type="custom";_.extend(this.outlets,this.customOutlets)}return this.outlets},e.prototype._createOutlet=function(t){var e,i,n;return i=this,e=t.getAttribute("data-outlet"),t.removeAttribute("data-outlet"),n=(t.tagName||"").toLowerCase(),("input"===n||"textarea"===n)&&t.addEventListener("change",function(){return function(){return i.updateOutletFromDom(e)}}(this)),this.outlets[e]={type:n,el:t},this.updateOutletFromDom(e)},e.prototype._createActions=function(){var t,e,i,n;for(this.actions={},e=this.el.querySelectorAll("[data-action]"),this.el.hasAttribute("data-action")&&this._createAction(this.el),i=0,n=e.length;n>i;i++)t=e[i],this._createAction(t);return this.actions},e.prototype._createAction=function(t){var i,n,s,r,o,l,h;for(s=this,n=t.getAttribute("data-action").split(";"),t.removeAttribute("data-action"),h=[],o=0,l=n.length;l>o;o++)r=n[o],i=r.match(e.actionPattern),i.shift(),i[2]=i[2].split(","),""===i[2][0]&&(i[2]=[]),lrs.LRSView.isTouch||"tap"!==i[0]&&"singleTap"!==i[0]||(i[0]="click"),this.actions[i[0]]||(this.actions[i[0]]=[]),t.addEventListener(i[0],function(t){return s.delegateAction(t,this)}),h.push(this.actions[i[0]].push({el:t,"function":i[1],parameters:i[2]}));return h},e.prototype.delegateAction=function(t,e){var i,n,s,r,o,l,h,u,c,a;if(null==e&&(e=!1),this.enabled&&(n=this.actions[t.type])){for(a=[],o=0,h=n.length;h>o;o++)if(i=n[o],e===!1||i.el===e){for(r=[],c=i.parameters,l=0,u=c.length;u>l;l++)s=c[l],r.push("null"===s?null:s.charAt(0).match(/['"]/g)&&s.charAt(0)===s.charAt(s.length-1)?s.substring(1,s.length-1):this[s]);r.push(this,e,t),a.push(this.dispatch(i["function"]+"Action",r))}return a}},e.prototype.dispatch=function(t,e){var i,n;return null==e&&(e=null),i=!0,this[t]&&_.isFunction(this[t])&&(i=this[t].apply(this,e)),i===!0&&(null!=(n=this.owner)?n.dispatch:void 0)?this.owner.dispatch(t,e):void 0},e.prototype.setOwner=function(t){return this.owner=t,this.owner},e.prototype.updateOutletFromDom=function(t){var e;return(e=this.outlets[t])?(this[t]=this.constructor.outletTypes[e.type]?this.constructor.outletTypes[e.type].get(e,this):this.constructor.outletTypes["default"].get(e,this),this):this},e.prototype.updateDomFromOutlet=function(t){var e;return(e=this.outlets[t])?(this.constructor.outletTypes[e.type]?this.constructor.outletTypes[e.type].set(e,this,this[t]):this.constructor.outletTypes["default"].set(e,this,this[t]),this):this},e.prototype.set=function(t,e){return this[t]=e,this.updateDomFromOutlet(t),this},e.prototype.appendTo=function(t){return(t.el||t).appendChild(this.el),this},e.prototype.insertBefore=function(t){var e;return e=t.el||t,e.parentNode.insertBefore(this.el,e),this},e.prototype.insertAfter=function(t){return this.insertBefore((t.el||t).nextSibling),this},e.prototype.withdraw=function(){var t,e,i;return i=this.el.scrollTop,e=this.el.parentNode,t=this.el.nextSibling,this.el.parentNode.removeChild(this.el),function(n){return function(){return t?e.insertBefore(n.el,t):e.appendChild(n.el),n.el.scrollTop=i}}(this)},e.prototype.remove=function(){return this.el.parentNode.removeChild(this.el),this},e.prototype.addClass=function(){var t;return t=1<=arguments.length?u.call(arguments,0):[],this.el.classList.add.apply(this.el.classList,t),this},e.prototype.removeClass=function(){var t;return t=1<=arguments.length?u.call(arguments,0):[],this.el.classList.remove.apply(this.el.classList,t),this},e.prototype.toggleClass=function(t,e){return this.el.classList.toggle(t,e)},e.prototype.hasClass=function(t){return this.el.classList.contains(t)},e.prototype.enable=function(t,e){return null==t&&(t=!0),null==e&&(e=!0),this.enabled=!0,e&&this.removeClass("disabled"),t===!0&&this.eachView(function(i){return i.enable(t,e)}),this},e.prototype.disable=function(t,e){return null==t&&(t=!0),null==e&&(e=!0),this.enabled=!1,e&&this.addClass("disabled"),t===!0&&this.eachView(function(i){return i.disable(t,e)}),this},e.prototype.show=function(){return this.hidden=!1,this.enable(!0,!1),this.removeClass("hidden"),this},e.prototype.hide=function(){return this.hidden=!0,this.disable(!0,!1),this.addClass("hidden"),this},e.prototype.hideAction=function(){return this.hide()},e.prototype.listenTo=function(t,e,i){return t.on(e,i),this.listeningTo||(this.listeningTo=[]),this.listeningTo.push({object:t,event:e,callback:i}),this},e.prototype.stopListeningTo=function(t,e,i){var n,s,r,o;if(!this.listeningTo)return this;for(o=this.listeningTo,s=0,r=o.length;r>s&&(n=o[s],n.object!==t||n.event!==e||n.callback!==i);s++);return n&&n.object.off(n.event,n.callback),this},e.prototype.deinitialize=function(){var t,e,i,n;if(this.listeningTo)for(n=this.listeningTo,e=0,i=n.length;i>e;e++)t=n[e],t.object.off(t.event,t.callback);return this.eachView(function(t){return t.deinitialize()})},e.prototype.eachView=function(t){var e,i,n,s,r;s=this.views,r=[];for(n in s)i=s[n],r.push(Array.isArray(i)?function(){var n,s,r;for(r=[],n=0,s=i.length;s>n;n++)e=i[n],r.push(t(e));return r}():t(i));return r},e}(lrs.LRSObject),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.initialize=function(t){return null==t&&(t=null),e.__super__.initialize.call(this),t&&this.views.content?(Array.isArray(this.views.content)||(this.views.content=[this.views.content]),this.setPreloadedContent(t)):this.reset(t),this},e.prototype.setPreloadedContent=function(t){var e,i,n,s,r,o,l,h,u,c,a;for(this.content=[],n=null,a=[],e=o=0,h=t.length;h>o;e=++o){for(i=t[e],r=null,c=this.views.content,l=0,u=c.length;u>l;l++)if(s=c[l],s.el.getAttribute("data-id")===i.id){r=s;break}r?r.initialize(i):(r=new this.options.itemClass(null,null,this).initialize(i),n?(r.insertAfter(n.el),this.views.content.splice(e,0,r)):r.appendTo(this.el)),a.push(this.content.push({object:i,view:r}))}return a},e.prototype.reset=function(t){var e,i,n,s,r,o,l,h,u;if(null!==t||this.content&&0!==this.content.length){if((s=this.views).content||(s.content=[]),this.views.content.length){for(u=this.views.content,r=0,l=u.length;l>r;r++)n=u[r],n.remove().deinitialize();this.views.content=[]}if(this.content=[],null!==t)for(e=o=0,h=t.length;h>o;e=++o)i=t[e],this._processObject(i,e);return this}},e.prototype.setContent=function(){return this.reset()},e.prototype.sort=function(t){var e,i,n,s,r,o,l,h,u,c,a;if(!(!t.length>0)&&this.content){for(i=[],n=[],l=0,u=t.length;u>l;l++)s=t[l],e=this.content[this.indexForObject(s)],i.push(e),n.push(e.view);for(this.content=i,this.views.content=n,r=this.withdraw(),a=this.views.content,h=0,c=a.length;c>h;h++)o=a[h],o.appendTo(this);return r()}},e.prototype.add=function(t,e){var i;return null==e&&(e=!1),e===!0?i=0:e===!1?i=this.content.length:(i=this.indexForObject(e),-1===i&&(i=this.content.length)),this._processObject(t,i)},e.prototype.addItem=function(){return this.add()},e.prototype.remove=function(t){var e,i;return e=this.indexForObject(t),-1===e?!1:(i=this.content.splice(e,1),this.views.content[e].remove().deinitialize(),this.views.content.splice(e,1))},e.prototype.removeItem=function(){return this.remove()},e.prototype.indexForObject=function(t){var e,i,n,s,r;for(r=this.content,i=n=0,s=r.length;s>n;i=++n)if(e=r[i],e.object===t)return i;return-1},e.prototype.indexForView=function(t){var e,i,n,s,r;for(r=this.content,i=n=0,s=r.length;s>n;i=++n)if(e=r[i],e.view===t)return i;return-1},e.prototype.viewForObject=function(t){var e;return e=this.indexForObject(t),-1===e?void 0:this.content[e].view},e.prototype._processObject=function(t,e){var i;return i=t.isView?t:this.options.itemClass?new this.options.itemClass(null,null,this).initialize(t):new lrs.LRSView.views.LRSGeneratedListItemView(this.options.subTemplate,null,this).initialize(t),e===this.views.content.length?i.appendTo(this.el):this.el.insertBefore(i.el,this.views.content[e].el),this.content.splice(e,0,{object:t,view:i}),this.views.content.splice(e,0,i),i},e}(s),e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e}(s),t=function(t){function e(t,i,n){this.options=i,this.owner=n,t&&(this.template=t),e.__super__.constructor.call(this,null,i,this.owner)}return h(e,t),e.prototype.initialize=function(t){var i,n,s,r;this.object=t,r=this.outlets;for(i in r)n=r[i],s=this.object.get(i),s&&this.set(i,s);return e.__super__.initialize.call(this,this.object)},e}(e),s.views.LRSListView=i,s.views.LRSListItemView=e,s.views.LRSGeneratedListItemView=t,lrs.LRSView=s}).call(this);